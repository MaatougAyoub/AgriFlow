<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>

<AnchorPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="controllers.MotDePasseOublie"
            prefHeight="520.0" prefWidth="720.0"
            style="-fx-background-color: #F5F5F5;">

    <!-- Carte centrée -->
    <VBox alignment="CENTER"
          AnchorPane.topAnchor="0.0" AnchorPane.bottomAnchor="0.0"
          AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0">

        <VBox spacing="18"
              alignment="CENTER"
              style="-fx-background-color: white; -fx-background-radius: 12; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.12), 18, 0, 0, 6); -fx-max-width: 520;">
            <padding>
                <Insets top="28" right="32" bottom="28" left="32"/>
            </padding>

            <Label text="Mot de passe oublié"
                   style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: #2E7D32;"/>

            <Label text="Saisissez votre email pour recevoir un code de réinitialisation."
                   wrapText="true"
                   style="-fx-text-fill: #616161; -fx-font-size: 13px;"/>

            <Label fx:id="errorLabel"
                   visible="false"
                   wrapText="true"
                   style="-fx-text-fill: #F44336; -fx-background-color: #FFEBEE; -fx-padding: 10; -fx-background-radius: 6;"/>

            <Label fx:id="successLabel"
                   visible="false"
                   wrapText="true"
                   style="-fx-text-fill: #2E7D32; -fx-background-color: #E8F5E9; -fx-padding: 10; -fx-background-radius: 6;"/>

            <!-- Etape 1 : Email -->
            <VBox fx:id="stepEmailBox" spacing="12" alignment="CENTER_LEFT">
                <GridPane vgap="12" hgap="12">
                    <columnConstraints>
                        <ColumnConstraints minWidth="90" prefWidth="130"/>
                        <ColumnConstraints hgrow="ALWAYS"/>
                    </columnConstraints>

                    <Label text="Email *" GridPane.rowIndex="0" GridPane.columnIndex="0"/>
                    <TextField fx:id="emailField" promptText="exemple@email.com"
                               GridPane.rowIndex="0" GridPane.columnIndex="1"/>
                </GridPane>

                <HBox spacing="12" alignment="CENTER">
                    <Button text="Envoyer le code"
                            style="-fx-background-color: #2E7D32; -fx-text-fill: white; -fx-padding: 10 22; -fx-font-size: 13px; -fx-font-weight: bold;"
                            onAction="#envoyerCode"/>

                    <Button text="Retour"
                            style="-fx-background-color: #757575; -fx-text-fill: white; -fx-padding: 10 22; -fx-font-size: 13px;"
                            onAction="#retourConnexion"/>
                </HBox>
            </VBox>

            <Separator/>

            <!-- Etape 2 : Code + Nouveau mot de passe (cachée au début) -->
            <VBox fx:id="stepResetBox" spacing="12" alignment="CENTER_LEFT" visible="false" managed="false">
                <Label text="Entrez le code reçu et choisissez un nouveau mot de passe."
                       wrapText="true"
                       style="-fx-text-fill: #616161; -fx-font-size: 13px;"/>

                <GridPane vgap="12" hgap="12">
                    <columnConstraints>
                        <ColumnConstraints minWidth="90" prefWidth="130"/>
                        <ColumnConstraints hgrow="ALWAYS"/>
                    </columnConstraints>

                    <Label text="Code *" GridPane.rowIndex="0" GridPane.columnIndex="0"/>
                    <TextField fx:id="codeField" promptText="Ex: 123456"
                               GridPane.rowIndex="0" GridPane.columnIndex="1"/>

                    <Label text="Nouveau mot de passe *" GridPane.rowIndex="1" GridPane.columnIndex="0"/>
                    <PasswordField fx:id="newPasswordField" promptText="********"
                                   GridPane.rowIndex="1" GridPane.columnIndex="1"/>

                    <Label text="Confirmer *" GridPane.rowIndex="2" GridPane.columnIndex="0"/>
                    <PasswordField fx:id="confirmPasswordField" promptText="********"
                                   GridPane.rowIndex="2" GridPane.columnIndex="1"/>
                </GridPane>

                <HBox spacing="12" alignment="CENTER">
                    <Button text="Réinitialiser"
                            style="-fx-background-color: #2E7D32; -fx-text-fill: white; -fx-padding: 10 22; -fx-font-size: 13px; -fx-font-weight: bold;"
                            onAction="#reinitialiserMotDePasse"/>

                    <Button text="Renvoyer le code"
                            style="-fx-background-color: #4CAF50; -fx-text-fill: white; -fx-padding: 10 18; -fx-font-size: 13px;"
                            onAction="#renvoyerCode"/>
                </HBox>
            </VBox>

        </VBox>
    </VBox>

</AnchorPane>