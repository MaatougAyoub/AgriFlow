<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.SVGPath?>

<VBox xmlns="http://javafx.com/javafx/17"
      xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="controllers.ListeParcelles"
      spacing="15"
      style="-fx-background-color: #F4F6F3;"
      stylesheets="@styles.css">

    <padding>
        <Insets top="20" right="20" bottom="20" left="20"/>
    </padding>

    <!-- Header (style Marketplace) -->
    <HBox spacing="15" alignment="CENTER_LEFT">
        <SVGPath content="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5S10.62 6.5 12 6.5s2.5 1.12 2.5 2.5S13.38 11.5 12 11.5z"
                 fill="#2D5A27" scaleX="1.2" scaleY="1.2"/>
        <Label text="Parcelles AgriFlow"
               style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #2D5A27;"/>
        <Region HBox.hgrow="ALWAYS"/>

        <!-- Visible seulement pour AGRICULTEUR (géré dans controller) -->
        <Button fx:id="btnAjouterParcelle"
                text="Ajouter une parcelle"
                styleClass="action-button"
                onAction="#ouvrirFenetreAjout">
            <graphic>
                <SVGPath content="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"
                         fill="white" scaleX="0.8" scaleY="0.8"/>
            </graphic>
        </Button>
        <Button text="Retour"
                onAction="#retourParcellesCultures"
                style="-fx-background-color: #2E7D32; -fx-text-fill: white; -fx-padding: 10 16; -fx-background-radius: 10;"/>

    </HBox>

    <!-- Barre filtres (style Marketplace) -->
    <VBox spacing="10"
          style="-fx-background-color: white; -fx-padding: 15; -fx-background-radius: 10; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 6, 0, 0, 2);">
        <HBox spacing="10" alignment="CENTER_LEFT">
            <SVGPath content="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                     fill="#9E9E9E" scaleX="0.8" scaleY="0.8"/>

            <TextField fx:id="searchField"
                       promptText="Rechercher par nom / localisation..."
                       style="-fx-padding: 10 15; -fx-background-radius: 8;"
                       HBox.hgrow="ALWAYS"/>

            <ComboBox fx:id="typeFilterCombo"
                      prefWidth="220"
                      style="-fx-background-radius: 8;"/>

            <Button fx:id="btnRechercher" text="Rechercher" onAction="#rechercher"
                    style="-fx-background-color:#2E7D32; -fx-text-fill:white; -fx-padding:10 16; -fx-background-radius:8;"/>

            <Button fx:id="btnRafraichir" text="Rafraîchir" onAction="#rafraichir"
                    style="-fx-background-color:#2E7D32; -fx-text-fill:white; -fx-padding:10 16; -fx-background-radius:8;"/>
        </HBox>
    </VBox>

    <Label fx:id="errorLabel"
           visible="false" managed="false" wrapText="true"
           style="-fx-text-fill:#B71C1C; -fx-background-color:#FFEBEE; -fx-padding:10; -fx-background-radius:8;"/>

    <Label fx:id="countLabel"
           text="0 parcelle(s)"
           style="-fx-font-size: 14px; -fx-text-fill: #757575;"/>

    <!-- ADMIN: Table -->
    <VBox fx:id="adminPane" spacing="10" VBox.vgrow="ALWAYS">
        <TableView fx:id="table" VBox.vgrow="ALWAYS">
            <columns>
                <TableColumn fx:id="colId" text="ID" prefWidth="60"/>
                <TableColumn fx:id="colAgriculteurId" text="Agriculteur ID" prefWidth="110"/>
                <TableColumn fx:id="colNom" text="Nom"/>
                <TableColumn fx:id="colSuperficie" text="Superficie"/>
                <TableColumn fx:id="colTypeTerre" text="Type Terre"/>
                <TableColumn fx:id="colLocalisation" text="Localisation"/>
                <TableColumn fx:id="colDateCreation" text="Date création"/>
                <TableColumn fx:id="colActions" text="Actions" prefWidth="120"/>
            </columns>
        </TableView>
    </VBox>

    <!-- AGRICULTEUR: Cards -->
    <VBox fx:id="agriculteurPane" spacing="10" visible="false" managed="false" VBox.vgrow="ALWAYS">
        <ScrollPane fx:id="cardsScroll" fitToWidth="true"
                    VBox.vgrow="ALWAYS"
                    style="-fx-background-color: transparent; -fx-background: transparent;">
            <content>
                <VBox fx:id="cardsContainer" spacing="12">
                    <padding>
                        <Insets top="4" right="4" bottom="4" left="4"/>
                    </padding>
                </VBox>
            </content>
        </ScrollPane>
    </VBox>

</VBox>
