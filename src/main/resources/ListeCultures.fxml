<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.SVGPath?>

<VBox xmlns="http://javafx.com/javafx/17"
      xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="controllers.ListeCultures"
      spacing="15"
      style="-fx-background-color: #F4F6F3;"
      stylesheets="@styles.css">

    <padding>
        <Insets top="20" right="20" bottom="20" left="20"/>
    </padding>

    <!-- Header style Marketplace -->
    <HBox spacing="15" alignment="CENTER_LEFT">
        <SVGPath content="M3 3h18v2H3V3zm2 4h14v14H5V7zm2 2v10h10V9H7z"
                 fill="#2D5A27" scaleX="1.2" scaleY="1.2"/>
        <Label text="Cultures AgriFlow"
               style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #2D5A27;"/>
        <Region HBox.hgrow="ALWAYS"/>

        <!-- Visible seulement AGRICULTEUR (géré dans controller) -->
        <Button fx:id="btnAjouterCulture"
                text="Ajouter une culture"
                styleClass="action-button"
                onAction="#ouvrirFenetreAjout">
            <graphic>
                <SVGPath content="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"
                         fill="white" scaleX="0.8" scaleY="0.8"/>
            </graphic>
        </Button>
        <Button fx:id="btnRetour" text="Retour" onAction="#retourParcellesCultures"
                style="-fx-background-color: #2E7D32; -fx-text-fill: white; -fx-padding: 8 18; -fx-background-radius: 10;"
        />

    </HBox>

    <!-- Filtres -->
    <VBox spacing="10"
          style="-fx-background-color: white; -fx-padding: 15; -fx-background-radius: 10; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.05), 6, 0, 0, 2);">
        <HBox spacing="10" alignment="CENTER_LEFT">

            <Label text="Etat:" style="-fx-font-weight: bold;"/>
            <ComboBox fx:id="etatFilterCombo" prefWidth="170" style="-fx-background-radius: 8;"/>

            <Label text="Type:" style="-fx-font-weight: bold;"/>
            <ComboBox fx:id="typeFilterCombo" prefWidth="170" style="-fx-background-radius: 8;"/>

            <TextField fx:id="searchField"
                       promptText="Rechercher par nom..."
                       style="-fx-padding: 10 15; -fx-background-radius: 8;"
                       HBox.hgrow="ALWAYS"/>

            <Button fx:id="btnRechercher" text="Rechercher" onAction="#rechercher"
                    style="-fx-background-color:#2E7D32; -fx-text-fill:white; -fx-padding:10 16; -fx-background-radius:8;"/>

            <Button fx:id="btnRafraichir" text="Rafraîchir" onAction="#rafraichir"
                    style="-fx-background-color:#2E7D32; -fx-text-fill:white; -fx-padding:10 16; -fx-background-radius:8;"/>
        </HBox>
    </VBox>

    <Label fx:id="errorLabel"
           visible="false" managed="false" wrapText="true"
           style="-fx-text-fill:#B71C1C; -fx-background-color:#FFEBEE; -fx-padding:10; -fx-background-radius:8;"/>

    <Label fx:id="countLabel"
           text="0 culture(s)"
           style="-fx-font-size: 14px; -fx-text-fill: #757575;"/>

    <!-- ADMIN: table -->
    <VBox fx:id="adminPane" spacing="10" VBox.vgrow="ALWAYS">
        <TableView fx:id="table" VBox.vgrow="ALWAYS">
            <columns>
                <TableColumn fx:id="colId" text="ID" prefWidth="60"/>
                <TableColumn fx:id="colParcelleId" text="Parcelle ID" prefWidth="90"/>
                <TableColumn fx:id="colProprietaireId" text="Propriétaire ID" prefWidth="110"/>
                <TableColumn fx:id="colNom" text="Nom"/>
                <TableColumn fx:id="colType" text="Type"/>
                <TableColumn fx:id="colSuperficie" text="Superficie"/>
                <TableColumn fx:id="colEtat" text="Etat"/>
                <TableColumn fx:id="colDateRecolte" text="Date récolte"/>
                <TableColumn fx:id="colRecolteEstime" text="Récolte estimée"/>
                <TableColumn fx:id="colDateCreation" text="Date création"/>
                <TableColumn fx:id="colActions" text="Actions" prefWidth="120"/>
            </columns>
        </TableView>
    </VBox>

    <!-- AGRICULTEUR: cards -->
    <VBox fx:id="agriculteurPane" spacing="10" visible="false" managed="false" VBox.vgrow="ALWAYS">
        <ScrollPane fx:id="cardsScroll" fitToWidth="true"
                    VBox.vgrow="ALWAYS"
                    style="-fx-background-color: transparent; -fx-background: transparent;">
            <content>
                <VBox fx:id="cardsContainer" spacing="12">
                    <padding>
                        <Insets top="4" right="4" bottom="4" left="4"/>
                    </padding>
                </VBox>
            </content>
        </ScrollPane>
    </VBox>

</VBox>
